# Gemini Robotics-ER 利用方針メモ

目的: できるだけ Gemini Robotics-ER の推論・ツールコールを活用して課題を解決する。

基本方針
- ルールベースを極力抑え、ER の推論結果に基づいて計画・距離推定・マップ推定を行う。
- ER への入力コンテキストを充実させる（画像、行動履歴、進捗、推定位置/地図）。
- 出力形式は JSON で明示し、複数ステップの plan 配列や推定マップを返させる。

検討中/実装予定の ER 活用例
- マルチステッププラン: ツール定義 (scan/turn/move_forward/approach/stop) を提示し、`plan` 配列を返させて実行キューに流す。
- 距離/方向推定: 連続フレームや BBox 高さ、行動ログを渡し、前進時間・角度を ER に推定させる。
- マップ推定: 最新画像と行動履歴（回転・前進の推定量、ジャイロ値があれば優先）を入力し、推定マップやターゲット位置を JSON で返させる。
- 進捗/スタック判定: `status/progress/comment` を ER に推定させ、再スキャンやプラン修正をトリガー。

実行側の役割
- セーフティと上限管理のみルールで担保（最大ステップ数、タイムアウト、暴走防止）。
- ER からの推定・プランはできるだけそのまま活用し、ログにプロンプト/レスポンスを保存して改善に生かす。

今後の提案方針
- 追加の改善提案は「Gemini Robotics-ER を用いて推定/計画させる方法」を優先し、ルール改変は最小限とする。
- センサー追加（ジャイロ等）は ER の推定精度向上に使う前提で検討する。
